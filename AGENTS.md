# Agent Rules Standard (AGENTS.md):

# Project: .agents

AI 코딩 에이전트(Roo Code, Claude Code)의 설정·커맨드·스킬·규칙을 심볼릭 링크로 중앙 관리하는 dotfiles 저장소.

## 기술 스택

- Shell (Bash) — 설정 자동화 스크립트
- Markdown — 커맨드, 스킬, 규칙 정의
- Symlink 기반 설정 배포

## 핵심 규칙

### Do

- `npm`, `yarn` 대신 항상 `pnpm`을 사용하라 (`npx` → `pnpx`). 프로젝트 전체 일관성을 위함.
- 커맨드 파일은 YAML frontmatter(`description`, `argument-hint`)를 포함하라. 에이전트가 커맨드 목록을 표시할 때 사용됨.
- 스킬 파일은 `skills/<스킬명>/SKILL.md` 경로를 따르라. Roo Code와 Claude Code 양쪽에서 인식하는 구조.
- `.claude/settings.json`은 민감 정보를 포함하므로 `.gitignore`에 반드시 유지하라.
- `setup.sh` 수정 시 기존 심볼릭 링크 구조와의 호환성을 유지하라. 기존 링크 경로가 변경되면 모든 프로젝트에서 설정이 깨짐.
- 참조 파일 목록이 주어진 경우 **작업 전 반드시 먼저 읽어라**. 정확한 정보 없이 추측으로 작성하면 재작업이 발생함.
- 대규모 파일은 전체를 한 번에 읽지 말고 **부분적으로 읽어라**. 컨텍스트 윈도우는 유한하며, 소진 시 작업 품질이 급락함.
- 설계 문서(`plans/` 등)가 있으면 **정확히 따르라**. 자의적 변경은 설계 의도를 훼손함.

### Don't

- `.backups/` 디렉토리의 내용을 Git에 커밋하지 마라.
- 커맨드·스킬 파일을 `~/.claude/`나 `~/.roo/`에 직접 작성하지 마라. 심볼릭 링크가 깨짐.
- **지시된 작업 범위를 넘어서 자의적으로 작업을 확장하지 마라.** 요청된 변경만 수행하라. 범위 일탈은 가장 빈번한 오류 원인이다.

## 작업 워크플로우

모든 작업은 아래 흐름을 따른다. 복잡한 변경일수록 이 단계를 엄격히 지켜라:

1. **분석**: 변경 대상 파일과 영향 범위를 파악한다. 관련 파일을 먼저 읽는다.
2. **계획**: 무엇을 어떻게 변경할지 정리한다. 불확실한 점이 있으면 **사용자에게 질문하라**.
3. **실행**: 계획에 따라 최소한의 변경만 수행한다.
4. **검증**: `setup.sh`가 정상 동작하는지, 심볼릭 링크가 올바른지 확인한다.

> 짧거나 모호한 지시를 받았을 때, 스스로 부족한 부분을 추측하지 말고 **사용자에게 확인하라**. 잘못된 추측보다 한 번의 질문이 낫다.

## 빌드 & 검증

```bash
# 심볼릭 링크 전체 설정 (백업 → 검증 → 생성)
bash setup.sh

# 개별 심볼릭 링크 확인
ls -la ~/.claude/commands/    # Claude Code 커맨드 링크
ls -la ~/.roo/commands/       # Roo Code 커맨드 링크
ls -la ~/.roo/rules/          # Roo Code 규칙 링크

# 특정 링크 대상 확인
readlink ~/.claude/commands/commit.md
```

## 프로젝트 구조

```
.agents/
├── setup.sh                      # 심볼릭 링크 설정 (백업 → 검증 → 생성)
├── commands/                     # 슬래시 커맨드 (/commit, /pr, /review 등)
├── skills/                       # 에이전트 스킬 (evaluate-instructions 등)
├── .claude/                      # Claude Code 설정 (settings.json)
├── .roo/rules/                   # Roo Code 글로벌 규칙
├── .backups/                     # 자동 백업 (gitignored)
├── README.md                     # 프로젝트 문서
└── AGENTS.md                     # 에이전트 지시 파일 (이 파일)
```

## 안전 경계

### 자율 수행

- 파일 읽기, 커맨드·스킬·규칙 파일 편집
- `setup.sh` 실행
- 린트, 포맷팅, 개별 파일 검증

### 확인 필요

- `.claude/settings.json` 내 MCP 서버·토큰 변경
- `setup.sh`의 심볼릭 링크 대상 경로 변경
- `.gitignore` 수정
- 파일 삭제, 디렉토리 구조 변경

## 에이전틱 행동 규칙

- 문제가 완전히 해결될 때까지 작업을 계속하라. 중간에 멈추지 마라.
- 추측하지 말고 **도구를 사용하라** — 파일 내용은 읽어서, 경로는 확인해서, 결과는 실행해서 파악하라.
- 대규모 작업은 **Batch로 분할**하라. 컨텍스트 윈도우를 의식하고, 각 배치의 결과를 중간 파일로 저장하라.

## README 최신 상태 유지

이 저장소에 구조적 변경(커맨드 추가/삭제, 스킬 추가/삭제, 규칙 변경, setup.sh 링크 대상 변경 등)이 발생하면 **반드시 `README.md`를 해당 변경사항에 맞게 업데이트**하라. 문서와 실제 동작이 불일치하면 사용자 혼란을 유발한다.

업데이트 대상 섹션:

- **프로젝트 구조**: 파일·디렉토리가 추가/삭제된 경우
- **커맨드 테이블**: `commands/`에 파일이 추가/삭제/수정된 경우
- **스킬 섹션**: `skills/`에 스킬이 추가/삭제된 경우
- **규칙 섹션**: `.roo/rules/rules.md`가 변경된 경우
- **setup.sh 동작 방식**: 심볼릭 링크 대상이 변경된 경우
